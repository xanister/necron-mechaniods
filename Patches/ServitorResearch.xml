<?xml version="1.0" encoding="utf-8"?>
<Patch>
  <!-- Update all mechanoid-related research to be about servitors -->
  
  <!-- BasicMechtech -> Basic Servitor Tech -->
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ResearchProjectDef[defName="BasicMechtech"]/label</xpath>
    <value>
      <label>basic servitor tech</label>
    </value>
  </Operation>
  
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ResearchProjectDef[defName="BasicMechtech"]/description</xpath>
    <value>
      <description>The sacred knowledge required for a tech-priest to construct and command basic servo skulls and servitor units. This foundational research unlocks the binharic protocols needed to interface with the machine-spirits of simple mechanical servants.</description>
    </value>
  </Operation>
  
  <!-- StandardMechtech -> Standard Servitor Tech -->
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ResearchProjectDef[defName="StandardMechtech"]/label</xpath>
    <value>
      <label>standard servitor tech</label>
    </value>
  </Operation>
  
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ResearchProjectDef[defName="StandardMechtech"]/description</xpath>
    <value>
      <description>Advanced knowledge of servitor construction protocols. This research is no longer used for crafting, but may be required for other advanced mechanitor technologies.</description>
    </value>
  </Operation>
  
  <!-- HighMechtech -> High Servitor Tech -->
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ResearchProjectDef[defName="HighMechtech"]/label</xpath>
    <value>
      <label>high servitor tech</label>
    </value>
  </Operation>
  
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ResearchProjectDef[defName="HighMechtech"]/description</xpath>
    <value>
      <description>Superior knowledge of servitor construction protocols. This research is no longer used for crafting, but may be required for other advanced mechanitor technologies.</description>
    </value>
  </Operation>
  
  <!-- UltraMechtech -> Ultra Servitor Tech -->
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ResearchProjectDef[defName="UltraMechtech"]/label</xpath>
    <value>
      <label>ultra servitor tech</label>
    </value>
  </Operation>
  
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ResearchProjectDef[defName="UltraMechtech"]/description</xpath>
    <value>
      <description>The most advanced knowledge of servitor construction protocols. This research is no longer used for crafting, but may be required for other advanced mechanitor technologies.</description>
    </value>
  </Operation>
  
  <!-- WastepackAtomizer -> Update description to be servitor-themed -->
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ResearchProjectDef[defName="WastepackAtomizer"]/label</xpath>
    <value>
      <label>wastepack atomizer</label>
    </value>
  </Operation>
  
  <Operation Class="PatchOperationReplace">
    <xpath>Defs/ResearchProjectDef[defName="WastepackAtomizer"]/description</xpath>
    <value>
      <description>Construct wastepack atomizers which can safely dispose of toxic wastepacks generated by servitor recharging stations. These sanctified devices decompose waste at the molecular level through sacred binharic rites, purifying the toxic byproducts of servitor power cycles.</description>
    </value>
  </Operation>

  <!-- Remove HighMechtech prerequisite from abstract CentipedeMechanoidRecipe -->
  <Operation Class="PatchOperationConditional">
    <xpath>Defs/RecipeDef[Name="CentipedeMechanoidRecipe"]/researchPrerequisite</xpath>
    <match Class="PatchOperationRemove">
      <xpath>Defs/RecipeDef[Name="CentipedeMechanoidRecipe"]/researchPrerequisite</xpath>
    </match>
  </Operation>
  
  <!-- Remove HighMechtech prerequisite from Diabolus -->
  <Operation Class="PatchOperationConditional">
    <xpath>Defs/RecipeDef[defName="Diabolus"]/researchPrerequisite</xpath>
    <match Class="PatchOperationRemove">
      <xpath>Defs/RecipeDef[defName="Diabolus"]/researchPrerequisite</xpath>
    </match>
  </Operation>
  
  <!-- Remove UltraMechtech prerequisite from abstract WalkerMediumMechanoidRecipe (parent of Legionary and Tesseron) -->
  <Operation Class="PatchOperationConditional">
    <xpath>Defs/RecipeDef[Name="WalkerMediumMechanoidRecipe"]/researchPrerequisite</xpath>
    <match Class="PatchOperationRemove">
      <xpath>Defs/RecipeDef[Name="WalkerMediumMechanoidRecipe"]/researchPrerequisite</xpath>
    </match>
  </Operation>
  
  <!-- Remove UltraMechtech prerequisite from CentipedeBlaster -->
  <Operation Class="PatchOperationConditional">
    <xpath>Defs/RecipeDef[defName="CentipedeBlaster"]/researchPrerequisite</xpath>
    <match Class="PatchOperationRemove">
      <xpath>Defs/RecipeDef[defName="CentipedeBlaster"]/researchPrerequisite</xpath>
    </match>
  </Operation>

  
  <!-- Remove from MechGestator (light mech gestator) -->
  <!-- Militor - Not replaced -->
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="MechGestator"]/recipes/li[. = "Militor"]</xpath>
  </Operation>
  
  <!-- Remove from LargeMechGestator (medium/heavy/superheavy mech gestator) -->
  <!-- Medium mechs - All not replaced -->
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "Scyther"]</xpath>
  </Operation>
  
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "Lancer"]</xpath>
  </Operation>
  
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "Pikeman"]</xpath>
  </Operation>
  
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "Scorcher"]</xpath>
  </Operation>
  
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "Tesseron"]</xpath>
  </Operation>
  
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "Legionary"]</xpath>
  </Operation>
  
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "CentipedeBlaster"]</xpath>
  </Operation>
  
  <!-- Heavy mechs - Not replaced (Tunneler is replaced, so we skip it) -->
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "CentipedeGunner"]</xpath>
  </Operation>
  
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "CentipedeBurner"]</xpath>
  </Operation>
  
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "Diabolus"]</xpath>
  </Operation>
  
  <!-- Superheavy mechs - All not replaced -->
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "Warqueen"]</xpath>
  </Operation>
  
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/ThingDef[defName="LargeMechGestator"]/recipes/li[. = "Centurion"]</xpath>
  </Operation>
  
  <!-- Cyclops - Uses recipeUsers instead of building recipe list (Odyssey DLC) -->
  <Operation Class="PatchOperationRemove">
    <xpath>Defs/RecipeDef[defName="Cyclops"]/recipeUsers/li[. = "LargeMechGestator"]</xpath>
  </Operation>
</Patch>

